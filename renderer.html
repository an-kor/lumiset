<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="module" src="js/lumiset/Lumiset"></script>
    <style>
        body {
            background-color: #111;
            color: #fff;
        }
    </style>
</head>
<body>
<!-- Todo List Template -->
<template id="todos-template">
    <div>
        <input type="text" :input="newTodo">
        <p :content="newTodo | i18n"></p>
        <template data-component="todoButton" :payload="{ action: 'doSomething()', content: 'newTodo' }"></template>
        <ul data-for="todo in todos">
            <template>
                <div>
                <template data-component="TodoItemComponent" :payload="todo"></template>
                </div>
            </template>
        </ul>
    </div>
</template>

<template id="todoButton">
    <div>
        <button data-click="@action" :content="@content"></button>
    </div>
</template>

<!-- Todo Item Template -->
<template id="TodoItemComponent">
        <span :content="@text"></span>
        <button data-click="removeTodo" :payload="@id" :id="@id" data-content="Delete | i18n">Delete</button>
</template>
<div id="app"></div>

<script type="module">
    import Lumiset from "./js/lumiset/index.js";
    let counterfort = Lumiset({ initialState:{ count: 0 }});
    window.store = counterfort.getStore()
    const router = counterfort.getRouter();

    store.addActions({
        addTodo: (store, payload) => {
            console.log('payload', payload)
            let todos = store.getState().todos;
            store.extendState({
                todos: [
                    ...todos,
                    { id: todos.length, text: payload }
                ]
            })
            console.log(store.getState())
        },
        removeTodo: (store, payload) => {
            store.setStateProperty('todos', store.getState().todos.filter(todo => todo.id !== payload));

        },
    })
    store.extendState({
        todos: [
            { id: 0, text: "Do laundry" },
            { id: 1, text: "Buy groceries" }
        ],
        newTodo: "Test"
    });

    store.subscribe((state, changes)=>{
        console.log('state listener', state, changes)
    });


    const todoListComponent = counterfort.render('todos-template');
    document.querySelector('#app').appendChild(todoListComponent);
    /*router.addRoutes([
        {
            path: '/users',
            handler: () => console.log('Users route accessed'),
            children: [
                {
                    path: '/:id',
                    handler: (params) => console.log('User ID:', params.id)
                }
            ]
        },
        {
            path: '/articles',
            handler: () => console.log('Articles route accessed')
        }
    ]);
    router.navigate('/users/12');*/

</script>
</body>
</html>